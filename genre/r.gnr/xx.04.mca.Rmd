---
title: "MCA Analysis "
output:
  pdf_document:
    highlight: tango
    fig_width: 7
    fig_height: 6
    fig_caption: true
    toc: true
    toc_depth: 4
    number_sections: true
---
```{r include=FALSE}
# Prepending general purpose libraries
source("../library.gnr/head.R")

# Requiring libraries, installing if needed
fun.install.require(c("rmarkdown", "beepr", "ggplot2", "xtable", "ca"))

# Loading the mca output generated by 04.mca.R
load("../data.gnr/mca.output.Rdata")

# Loading cluster membership data generated by 03.cca.R
load("../data.gnr/cca.membership.Rdata")

# Loading the list with different mca analysis for each cca cluster
load("../data.gnr/mca.cluster.output.Rdata")

# Loading cca zero cluster
load("../data.gnr/cca.zeros.Rdata")

# Loading the music data
load("../data.gnr/music.Rdata")
# Array of descriptors
arr.groupby <- c("gender","age5", "occupation", "educ3", "habitat", "fam.3niv")
## df.descriptors  <- df.music[, c(169, 171, 174, 167, 185, 181)]
df.descriptors  <- df.music[, c(181,174)]
df.descriptors  <- df.descriptors[-cca.zeros, ]

```


# Summary

# XX Graph With All Observations Without Descriptors

```{r, results='asis', echo=F, fig.width=9, fig.height=5.5}
plot(mca.output)

plot(mca.output, )
```

# XX Descriptors

```{r, results='asis', echo=F, fig.width=9, fig.height=5.5}
plot(mca.output)
```

# XX Graph With All Observations Without Descriptors

```{r, results='asis', echo=F, fig.width=9, fig.height=5.5}
plot(mca.output)
```

```{r, results='asis', echo=F, fig.width=9, fig.height=5.5}
cat("\n\n \\pagebreak \n\n")

# for each cca module plot the mca graph
for(cnt.i in 1:length(levels(as.factor(cca.membership)))){
  cat(sprintf("\n\n## XX Graph For Observations In CCA Module %s \n\n", cnt.i))
  tmp.mca.output <- mca.cluster.output[[cnt.i]]


  plot(tmp.mca.output)
  cat("\n\n \\pagebreak \n\n")
}
```

# XX Graph Colored by CCA clusters

```{r, results='asis', echo=F, fig.width=9, fig.height=5.5}
# Different colors for each cluster
color <- c("red", "green", "blue")
# Ploting cellipse mca groups colored by cca clusters


# prqnt(boxplot(mca.output))
# print(scatter.dudi(mca.output))
# print(apply(mca.output$cr, 2, mean))
# print(mca.output$eig[1:mca.output$nf])
# scatter(mca.output)
# s.value(mca.output$li, mca.output$li[,2])
```
