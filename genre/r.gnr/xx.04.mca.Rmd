---
title: "MCA Analysis "
output:
  pdf_document:
    highlight: tango
    fig_width: 7
    fig_height: 6
    fig_caption: true
    toc: true
    toc_depth: 4
    number_sections: true
---
```{r include=FALSE}
# Prepending general purpose libraries
source("../library.gnr/head.R")

# Requiring libraries, installing if needed
fun.install.require(c("rmarkdown", "beepr", "ggplot2", "xtable", "ade4"))

# Loading the mca output generated by 04.mca.R
load("../data.gnr/mca.output.Rdata")

# Loading cluster membership data generated by 03.cca.R
load("../data.gnr/cca.membership.Rdata")

# Loading the list with different mca analysis for each cca cluster
load("../data.gnr/mca.cluster.output.Rdata")
```

# CCA

## Summary

### XX Graph With All Observations

```{r, results='asis', echo=F, fig.width=9, fig.height=5.5}
s.arrow(mca.output$co, xax=1, yax=2, boxes=F, clabel=0.75, grid=F, possub="topleft") 

cat("\n\n \\pagebreak \n\n")

# for 
for(cnt.i in 1:length(levels(as.factor(cca.membership)))){
  print(sprintf("\n\n #### XX Graph For Observations In CCA Module %s \n\n", cnt.i))
  tmp.mca.output <- mca.cluster.output[[cnt.i]]
  s.arrow(tmp.mca.output$co, xax=1, yax=2, boxes=F, clabel=0.75, grid=F, possub="topleft", sub="Module 1")
  cat("\n\n \\pagebreak \n\n")
}

# Different colors for each cluster
color <- c("red", "green", "blue")
# Ploting cellipse mca groups colored by cca clusters
s.class(mca.output$li, as.factor(cca.membership), cellipse = 2, col=color)


# prqnt(boxplot(mca.output))
# print(scatter.dudi(mca.output))
# print(apply(mca.output$cr, 2, mean))
# print(mca.output$eig[1:mca.output$nf])
# scatter(mca.output)
# s.value(mca.output$li, mca.output$li[,2])
```
