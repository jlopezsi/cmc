---
title: "CCA and RCA Analysis "
output:
  pdf_document:
    highlight: tango
    fig_width: 7
    fig_height: 6
    fig_caption: true
    toc: true
    toc_depth: 4
    number_sections: true
---
```{r include=FALSE}

source("../config.R")
source(prj.head)

fun.install.require(c("rmarkdown", "beepr", "ggplot2", "xtable", "corclass", "RCA"))

load("../data.gnr/cca.output.Rdata")
```
# CCA

## Summary

```{r, results='asis', echo=F, fig.width=9, fig.height=5.5}
print.cca(cca.output)

print(xtable(summary(cca.output)), type="latex", comment=F)
```

\pagebreak

## Modules

```{r, results='asis', echo=F, fig.width=9, fig.height=5.5}
cat("\n\n \\pagebreak \n\n ")

for(cnt.i in 1:length(cca.output$modules)){
  cat(sprintf("\n\n### Module %s \n\n", cnt.i))

  cat(sprintf("\n\n#### Module %s -  Kamada Kawai Layout \n\n", cnt.i))

  plot(cca.output, cnt.i, bw=T, drop.neg.ties.for.layout=F)

  cat("\n\n \\pagebreak \n\n ")

  cat(sprintf("\n\n#### Module %s -  Fruchtername Reingold Layout \n\n", cnt.i))

  plot(cca.output, cnt.i, LAYOUT = layout.fruchterman.reingold, bw=T,
       drop.neg.ties.for.layout=F)

  cat("\n\n \\pagebreak \n\n ")
}
```

# RCA

```{r, results='asis', echo=F, fig.width=9, fig.height=5.5}
vec.rca <- c(0.05, 0.075, 0.1, 0.25, 0.5)
for(key.p in vec.rca){
  cat(sprintf("\n\n## RCA P = %s \n\n", key.p))

  load(sprintf("../data.gnr/rca.output.%s.Rdata",key.p))
  print(xtable(summary(rca.output)), type="latex", comment=F)

  cat("\n\n \\pagebreak \n\n ")
}
```

\pagebreak

