% Combinatorial Structure of the Deterministic Seriation Method with Multiple Spatial Solutions



##### keywords
seriation | combinatorics | algorithms | cultural transmission

# Abstract

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed dictum mauris quis turpis pellentesque, quis porta arcu varius. Suspendisse dictum at odio id luctus. Curabitur ut tristique nisl. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vivamus molestie at elit a sodales. Vestibulum suscipit leo sed semper facilisis. Nam lacinia lobortis imperdiet. Nulla facilisi. Duis suscipit elementum risus, vitae molestie eros accumsan ut. Nulla facilisi. Praesent quis adipiscing sem. Interdum et malesuada fames ac ante ipsum primis in faucibus.


``` {r libraries, echo=FALSE, cache=FALSE}
library(ggplot2)
library(randtoolbox)
library(xtable)
options(tikzDefaultEngine = "xetex")
```

# Introduction

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed dictum mauris quis turpis pellentesque, quis porta arcu varius. Suspendisse dictum at odio id luctus. Curabitur ut tristique nisl. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vivamus molestie at elit a sodales. Vestibulum suscipit leo sed semper facilisis. Nam lacinia lobortis imperdiet. Nulla facilisi. Duis suscipit elementum risus, vitae molestie eros accumsan ut. Nulla facilisi. Praesent quis adipiscing sem. Interdum et malesuada fames ac ante ipsum primis in faucibus.

# Single Seriation Combinatorics

```{r singleseriation, echo=FALSE, results='asis'}
parallelism <- 4  # number of cores for parallel testing of possible solutions
secs_per_trial <- 0.005  # 5 millseconds per trial

single_seriation_stats <- function(n) {
  total_trials <- (factorial(n) / 2)
  trial_batches <- total_trials / parallelism
  
  days_in_avg_month <- 30.4368
  time_batches_sec <- trial_batches * secs_per_trial
  time_batches_days <- time_batches_sec / 86400
  time_batches_months <- time_batches_days / days_in_avg_month
  time_batches_years <- time_batches_days / 365.25
  times <- c(n, total_trials, time_batches_sec,time_batches_years)
}

sscomb <- data.frame(matrix(ncol=3,nrow=0))

nseq <- c(seq(from=4, to=10, by=2), 12, 13, 14, 15, 16, seq(from=20, to=100, by=20))

for(n in nseq) {
  sscomb <- rbind(sscomb, single_seriation_stats(n))
}

colnames(sscomb) <- c("N", "Seriation Solutions", "Seconds","Years")
capt <- paste("Number of unique seriation solutions and parallel processing time for sets of assemblages $4 < n < 100$, testing solutions across",parallelism,"cores, assuming 5ms per trial",sep=" ")
```

Since the factorial function grows so quickly, the computational cost of determining the correct permutation within a given seriation solution group is controlled by the size of the largest subset, especially if the other subsets are relatively small, as in the previous example.  At worst, for a solution set with $m$ solution groups, $m-1$ solution groups will contain 1 assemblage each, and the last solution group will consist of the remaining $n-m-1$ assemblages.  This means, of course, that the worst case would involve consideration of on the order of $(n-m-1)!$ permutations within each solution group, for each of the subsets given by Equation \ref{eq:sum-stirling}.  This yields:


$$\sum_{m=1}^n \stirlingsubset{n}{m} (n-m-1)!$$

Table \ref{tab:total-mult} gives the total number of possible solutions for assemblages ranging from 4 to 100, where solutions may fall into multiple seriation groups of any size.  

```{r totalsolutionstable, results='asis', echo=FALSE}
capt <- paste("Number of total solutions with multiple seriation groups and processing time for sets of assemblages 4 < n < 100, testing solutions across",parallelism,"cores",sep=" ")
data(tli)
xt3 <- xtable(tli[1:4,1:10], align="|c|c|r|r|r|", display=c("d","d","g","g","g"),caption=c("Test Table"), label="tab:total-mult")

print(xt3, include.rownames=FALSE)
```

# Conclusions

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed dictum mauris quis turpis pellentesque, quis porta arcu varius. Suspendisse dictum at odio id luctus. Curabitur ut tristique nisl. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vivamus molestie at elit a sodales. Vestibulum suscipit leo sed semper facilisis. Nam lacinia lobortis imperdiet. Nulla facilisi. Duis suscipit elementum risus, vitae molestie eros accumsan ut. Nulla facilisi. Praesent quis adipiscing sem. Interdum et malesuada fames ac ante ipsum primis in faucibus.




# Acknowledgements

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed dictum mauris quis turpis pellentesque, quis porta arcu varius. Suspendisse dictum at odio id luctus. Curabitur ut tristique nisl. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vivamus molestie at elit a sodales. Vestibulum suscipit leo sed semper facilisis. Nam lacinia lobortis imperdiet. Nulla facilisi. Duis suscipit elementum risus, vitae molestie eros accumsan ut. Nulla facilisi. Praesent quis adipiscing sem. Interdum et malesuada fames ac ante ipsum primis in faucibus.



